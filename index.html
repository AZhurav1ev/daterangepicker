<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="./codebase/webix.min.js"></script>
    <link rel="stylesheet" href="./codebase/webix.min.css">
    <title>Multi download test</title>
</head>

<body>
    <script src="browser.js"></script>
    <script src="pdfdoc.js"></script>
    <script src="csvData.js"></script>
    <script>
        webix.ready(function () {
            webix.ui({
                rows: [
                    {},
                    {
                        cols: [
                            {},
                            {
                                rows: [
                                    { template: `version 1.3`, autoheight: true, borderless: true },
                                    {
                                        view: "button",
                                        value: "Download csv",
                                        autowidth: true,
                                        click: function () {
                                            const urlArray = [];

                                            for (let i = 0; i < 3; i++) {
                                                urlArray.push('data:text/csv;charset=utf-8,' + encodeURIComponent(csvContent));
                                            }

                                            multiDownload(urlArray, { rename: ({ index }) => `test${index}.csv` });

                                            // working solution for one file
                                            // let dataUrl = 'data:text/csv;charset=utf-8,' + encodeURIComponent(csvContent);
                                            // let link = document.createElement('a');
                                            // link.download = 'test.csv';
                                            // link.href = dataUrl;

                                            // document.body.appendChild(link);
                                            // link.click();
                                            // document.body.removeChild(link);
                                        }
                                    }
                                ]
                            },
                            {}
                        ]
                    },
                    {}
                ]
            });
        });
    </script>
</body>

</html>